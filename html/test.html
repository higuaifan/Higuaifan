<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <script src="../js/jquery.js"></script>
</head>
<body>
 <button type="button" class="captcha" id="btn-confirm">获取验证码</button>
</body>
</html>


<script>

    $(document).ready(function(){
        var wait=10;
        function time() { 
            var o=$("#btn-confirm");
            console.log(wait);
            if (wait == 0) { 
                o.removeAttr("disabled"); 
                o.html("获取验证码"); 
                wait = 10; 
            } else {
            var reg = /^[1-9]\d*$|^0$/;  //数字校验
                    var mobile = $("#mobile").val();
                    if (!/1\d{2}/.test(mobile) || mobile.length != "11" || reg.test(mobile) == false) {
                        alert("手机号格式不正确");
                        return;
                    }
                $.ajax({
                    url: '/sdk/QRSign/sendMessage',
                    type: 'post',
                    data: {
                        appId: getAppId(),
                        captcha: $captcha_code.val(),
                        mobile: mobile
                    },
                    dataType: 'json',
                    success: function (data) {
                        //console.log(data);
                        if (data.code == 200 && data.subCode == 200) {
                            alert('验证码发送成功');
                        } else {
                            alert(data.message);
                        }
                    },
                    error: function () {
                        alert('系统异常');
                    }
                });

                o.attr("disabled",true);
                o.html(wait+"秒后可重发"); 
                wait--; 
                setTimeout(function() { 
                    time(o) 
                }, 
                1000) 
            } 
        };
        $("#btn-getVerifyCode").click(function(){
            time(this);
        });
        
    });


</script>